import"../chunks/DsnmJJEf.js";import{w as _r,G as gr,H as yr,I as xr,J as hr,K as $r,p as wr,a as kr,f as k,h as qr,b as f,c as Sr,$ as zr,t as O,e as t,n as x,r as a,g as i,i as v,s as pr,l as F,d as h}from"../chunks/DOqfio9a.js";import{d as Cr,s as D,e as Lr}from"../chunks/BBi-XrFn.js";import{i as Pr}from"../chunks/C8tlNBLB.js";import{B as E,C as jr,e as Jr,i as Mr,a as Tr}from"../chunks/D83_P9YZ.js";import{r as p}from"../chunks/BW3stNb9.js";import{b as m}from"../chunks/B_lpGf7e.js";import{g as Ar}from"../chunks/BtGwx0k-.js";function mr(s,l,r=!1){if(s.multiple){if(l==null)return;if(!xr(l))return hr();for(var d of s.options)d.selected=l.includes(w(d));return}for(d of s.options){var o=w(d);if($r(o,l)){d.selected=!0;return}}(!r||l!==void 0)&&(s.selectedIndex=-1)}function Br(s){var l=new MutationObserver(()=>{mr(s,s.__value)});l.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),yr(()=>{l.disconnect()})}function Rr(s,l,r=l){var d=!0;_r(s,"change",o=>{var c=o?"[selected]":":checked",$;if(s.multiple)$=[].map.call(s.querySelectorAll(c),w);else{var _=s.querySelector(c)??s.querySelector("option:not([disabled])");$=_&&w(_)}r($)}),gr(()=>{var o=l();if(mr(s,o,d),d&&o===void 0){var c=s.querySelector(":checked");c!==null&&(o=w(c),r(o))}s.__value=o,d=!1}),Br(s)}function w(s){return"__value"in s?s.__value:s.value}function Nr(s,l){l.name&&!l.output_dir&&(l.output_dir=`./models/${l.name.toLowerCase().replace(/[^a-z0-9]/g,"-")}`)}var Or=k('<div class="p-4 bg-red-50 border border-red-200 rounded-lg"><p class="text-red-700"> </p></div>'),Fr=k("<option> </option>"),Dr=k('<form class="space-y-6"><!> <div><h3 class="text-lg font-semibold text-gray-900 mb-4">Basic Configuration</h3> <div class="grid grid-cols-1 gap-4"><div><label for="name" class="block text-sm font-medium text-gray-700 mb-1">Model Name *</label> <input type="text" id="name" placeholder="my-finance-model" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required/></div> <div><label for="base_model" class="block text-sm font-medium text-gray-700 mb-1">Base Model *</label> <select id="base_model" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required></select></div> <div><label for="dataset_path" class="block text-sm font-medium text-gray-700 mb-1">Dataset Path *</label> <input type="text" id="dataset_path" placeholder="./data/my-dataset.jsonl" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required/> <p class="text-xs text-gray-500 mt-1">Path to your JSONL dataset file</p></div> <div><label for="output_dir" class="block text-sm font-medium text-gray-700 mb-1">Output Directory</label> <input type="text" id="output_dir" placeholder="./models/my-model" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"/></div></div></div> <div><h3 class="text-lg font-semibold text-gray-900 mb-4">Training Hyperparameters</h3> <div class="grid grid-cols-2 gap-4"><div><label for="learning_rate" class="block text-sm font-medium text-gray-700 mb-1">Learning Rate</label> <input type="number" id="learning_rate" step="0.00001" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"/></div> <div><label for="num_epochs" class="block text-sm font-medium text-gray-700 mb-1">Epochs</label> <input type="number" id="num_epochs" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"/></div> <div><label for="batch_size" class="block text-sm font-medium text-gray-700 mb-1">Batch Size</label> <input type="number" id="batch_size" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"/></div> <div><label for="max_steps" class="block text-sm font-medium text-gray-700 mb-1">Max Steps</label> <input type="number" id="max_steps" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"/> <p class="text-xs text-gray-500 mt-1">-1 for full epochs</p></div></div></div> <div><h3 class="text-lg font-semibold text-gray-900 mb-4">LoRA Configuration</h3> <div class="grid grid-cols-2 gap-4"><div><label for="lora_r" class="block text-sm font-medium text-gray-700 mb-1">LoRA Rank (r)</label> <input type="number" id="lora_r" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"/></div> <div><label for="lora_alpha" class="block text-sm font-medium text-gray-700 mb-1">LoRA Alpha</label> <input type="number" id="lora_alpha" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"/></div></div></div> <div class="flex gap-4 pt-4"><!> <!></div></form>'),Er=k('<div class="min-h-screen bg-gray-50"><div class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center py-6"><div class="flex items-center"><!> <h1 class="text-3xl font-bold text-gray-900 ml-4">New Training Job</h1></div></div></div></div> <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!></div></div>');function Xr(s,l){wr(l,!0);let r=kr({name:"",base_model:"unsloth/tinyllama-bnb-4bit",dataset_path:"./data/sample.jsonl",output_dir:"",hyperparameters:{learning_rate:2e-4,num_epochs:3,batch_size:2,max_steps:-1,gradient_accumulation_steps:4},lora_config:{r:16,lora_alpha:16},from_hub:!1}),d=pr(!1),o=pr("");const c=["unsloth/tinyllama-bnb-4bit","unsloth/phi-2-bnb-4bit","unsloth/mistral-7b-bnb-4bit","unsloth/llama-2-7b-bnb-4bit","unsloth/llama-3-8b-bnb-4bit"];async function $(g){if(g.preventDefault(),!r.name||!r.base_model||!r.dataset_path){h(o,"Please fill in all required fields");return}h(d,!0),h(o,"");try{const b=await Tr.createTrainingJob(r);b.success?Ar(`/training/${b.data.job_id}`):h(o,"Failed to create training job")}catch(b){h(o,b instanceof Error?b.message:"Failed to create training job",!0)}finally{h(d,!1)}}var _=Er();qr(g=>{zr.title="New Training Job - Model Garden"});var q=t(_),G=t(q),H=t(G),I=t(H),vr=t(I);E(vr,{href:"/training",variant:"ghost",size:"sm",children:(g,b)=>{x();var y=O("← Training Jobs");f(g,y)},$$slots:{default:!0}}),x(2),a(I),a(H),a(G),a(q);var K=i(q,2),cr=t(K);jr(cr,{children:(g,b)=>{var y=Dr(),Q=t(y);{var br=e=>{var u=Or(),n=t(u),N=t(n,!0);a(n),a(u),F(()=>D(N,v(o))),f(e,u)};Pr(Q,e=>{v(o)&&e(br)})}var S=i(Q,2),U=i(t(S),2),z=t(U),C=i(t(z),2);p(C),C.__input=[Nr,r],a(z);var L=i(z,2),P=i(t(L),2);Jr(P,21,()=>c,Mr,(e,u)=>{var n=Fr(),N=t(n,!0);a(n);var ur={};F(()=>{D(N,v(u)),ur!==(ur=v(u))&&(n.value=(n.__value=v(u))??"")}),f(e,n)}),a(P),a(L);var j=i(L,2),V=i(t(j),2);p(V),x(2),a(j);var W=i(j,2),X=i(t(W),2);p(X),a(W),a(U),a(S);var J=i(S,2),Y=i(t(J),2),M=t(Y),Z=i(t(M),2);p(Z),a(M);var T=i(M,2),rr=i(t(T),2);p(rr),a(T);var A=i(T,2),er=i(t(A),2);p(er),a(A);var ar=i(A,2),tr=i(t(ar),2);p(tr),x(2),a(ar),a(Y),a(J);var B=i(J,2),ir=i(t(B),2),R=t(ir),sr=i(t(R),2);p(sr),a(R);var lr=i(R,2),or=i(t(lr),2);p(or),a(lr),a(ir),a(B);var dr=i(B,2),nr=t(dr);E(nr,{type:"submit",variant:"primary",get loading(){return v(d)},get disabled(){return v(d)},children:(e,u)=>{x();var n=O();F(()=>D(n,v(d)?"Creating...":"Start Training")),f(e,n)},$$slots:{default:!0}});var fr=i(nr,2);E(fr,{href:"/training",variant:"secondary",children:(e,u)=>{x();var n=O("Cancel");f(e,n)},$$slots:{default:!0}}),a(dr),a(y),Lr("submit",y,$),m(C,()=>r.name,e=>r.name=e),Rr(P,()=>r.base_model,e=>r.base_model=e),m(V,()=>r.dataset_path,e=>r.dataset_path=e),m(X,()=>r.output_dir,e=>r.output_dir=e),m(Z,()=>r.hyperparameters.learning_rate,e=>r.hyperparameters.learning_rate=e),m(rr,()=>r.hyperparameters.num_epochs,e=>r.hyperparameters.num_epochs=e),m(er,()=>r.hyperparameters.batch_size,e=>r.hyperparameters.batch_size=e),m(tr,()=>r.hyperparameters.max_steps,e=>r.hyperparameters.max_steps=e),m(sr,()=>r.lora_config.r,e=>r.lora_config.r=e),m(or,()=>r.lora_config.lora_alpha,e=>r.lora_config.lora_alpha=e),f(g,y)},$$slots:{default:!0}}),a(K),a(_),f(s,_),Sr()}Cr(["input"]);export{Xr as component};
