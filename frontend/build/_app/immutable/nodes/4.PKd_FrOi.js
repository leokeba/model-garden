import"../chunks/DsnmJJEf.js";import{q as le,p as ve,s as C,a as ne,o as ce,f as x,h as ue,k as gt,b as v,c as me,$ as _e,t as B,i as a,g as s,u as I,e,n as w,r as t,d as p,l as D,m as g}from"../chunks/ZXdHezLC.js";import{i as N}from"../chunks/CnQbhIlQ.js";import{a as Bt,e as ge,s as pe,i as xe}from"../chunks/C2YVWTdS.js";import{b as Dt}from"../chunks/RUopsz-q.js";import{B as A,a as Rt,C as R}from"../chunks/ByOzdI1s.js";import{B as fe}from"../chunks/xrVGPLka.js";var ye=(tt,W)=>p(W,""),be=x('<div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"><div class="flex items-start"><span class="text-red-600 mr-2">‚ö†Ô∏è</span> <div class="flex-1"><p class="text-sm text-red-800"> </p></div> <button class="text-red-600 hover:text-red-800">‚úï</button></div></div>'),$e=x('<div class="flex justify-center items-center h-64"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div></div>'),he=x('<div class="p-6"><div class="text-sm font-medium text-gray-500 mb-1">Total Jobs</div> <div class="text-3xl font-bold text-gray-900"> </div></div>'),we=x('<div class="p-6"><div class="text-sm font-medium text-gray-500 mb-1">Total Emissions</div> <div> </div> <div class="text-xs text-gray-500 mt-1">CO‚ÇÇ equivalent</div></div>'),ke=x('<div class="p-6"><div class="text-sm font-medium text-gray-500 mb-1">Total Energy</div> <div class="text-3xl font-bold text-gray-900"> </div></div>'),je=x('<div class="p-6"><div class="text-sm font-medium text-gray-500 mb-1">Avg Carbon Intensity</div> <div class="text-3xl font-bold text-gray-900"> </div> <div class="text-xs text-gray-500 mt-1">g CO‚ÇÇ/kWh</div></div>'),Ee=x('<div class="p-4"><div class="flex flex-wrap gap-4 items-center"><div class="flex-1 min-w-[200px]"><label for="stage-filter" class="block text-sm font-medium text-gray-700 mb-2">Filter by Stage</label> <select id="stage-filter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm"><option>All Stages</option><option>Training</option><option>Inference</option></select></div> <div class="flex-1 min-w-[200px]"><label for="sort-by" class="block text-sm font-medium text-gray-700 mb-2">Sort By</label> <select id="sort-by" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm"><option>Date (Newest First)</option><option>Emissions (Highest First)</option><option>Duration (Longest First)</option></select></div> <div class="flex-shrink-0 flex items-end"><!></div></div></div>'),Se=x('<div class="text-center py-12"><div class="text-6xl mb-4">üå±</div> <h3 class="text-xl font-semibold text-gray-700 mb-2">No emissions data yet</h3> <p class="text-gray-500 mb-6">Start training or running inference to track carbon emissions</p> <!></div>'),Pe=x('<div class="p-6"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3 mb-2"><h3 class="text-lg font-semibold text-gray-900"> </h3> <!></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"><div><div class="text-gray-500">Model</div> <div class="font-medium text-gray-900"> </div></div> <div><div class="text-gray-500">Emissions</div> <div> </div></div> <div><div class="text-gray-500">Energy</div> <div class="font-medium text-gray-900"> </div></div> <div><div class="text-gray-500">Duration</div> <div class="font-medium text-gray-900"> </div></div> <div><div class="text-gray-500">Carbon Intensity</div> <div class="font-medium text-gray-900"> </div></div> <div><div class="text-gray-500">Location</div> <div class="font-medium text-gray-900"> </div></div> <div><div class="text-gray-500">Date</div> <div class="font-medium text-gray-900 truncate"> </div></div> <div><div class="text-gray-500">Energy Breakdown</div> <div class="font-medium text-gray-900 text-xs"> </div></div></div></div> <div class="ml-4 flex flex-col gap-2"><!> <!></div></div></div>'),Ce=x('<div class="space-y-4"></div>'),Be=x('<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"><!> <!> <!> <!></div> <!> <!>',1),De=(tt,W)=>{p(W,null)},Re=x('<div class="flex justify-center items-center h-32"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div></div>'),Le=x('<pre class="text-sm text-gray-900 whitespace-pre-wrap overflow-x-auto bg-gray-50 p-4 rounded-lg"> </pre>'),Oe=x('<div class="p-6 border-b border-gray-200"><div class="flex justify-between items-center"><div><h2 class="text-2xl font-bold text-gray-900">BoAmps Report</h2> <p class="text-sm text-gray-600 mt-1">Standardized emissions report</p></div> <button class="text-gray-400 hover:text-gray-600">‚úï</button></div></div> <div class="flex-1 overflow-y-auto p-6"><!></div> <div class="p-6 border-t border-gray-200 flex gap-3"><!> <!></div>',1),Te=x('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"><!></div>'),Me=x('<div class="min-h-screen bg-gray-50 pt-6"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="flex justify-between items-center mb-8"><div><h1 class="text-3xl font-bold text-gray-900">üå± Carbon Emissions</h1> <p class="mt-2 text-sm text-gray-600">Track and analyze the carbon footprint of your AI models</p></div> <!></div> <!> <!></div></div> <!>',1);function ze(tt,W){ve(W,!0);let h=C(ne([])),et=C(!0),F=C(""),Q=C("all"),rt=C("date"),pt=I(()=>a(h).reduce((r,o)=>r+o.emissions_kg,0)),Lt=I(()=>a(h).reduce((r,o)=>r+o.energy_consumed,0)),Ot=I(()=>a(h).length>0?a(h).reduce((r,o)=>r+o.carbon_intensity,0)/a(h).length:0),at=I(()=>a(h).filter(r=>a(Q)==="all"||r.stage===a(Q)).sort((r,o)=>{switch(a(rt)){case"emissions":return o.emissions_kg-r.emissions_kg;case"duration":return o.duration-r.duration;case"date":default:return new Date(o.timestamp).getTime()-new Date(r.timestamp).getTime()}})),L=C(null),st=C(!1),Tt=C(!1);async function xt(){try{p(et,!0),p(F,"");const r=await Rt.get("/carbon/emissions");p(h,r.emissions||[],!0)}catch(r){p(F,r instanceof Error?r.message:"Failed to load emissions data",!0),p(h,[],!0)}finally{p(et,!1)}}async function Mt(r){try{p(st,!0);const o=await Rt.get(`/carbon/boamps/${r}`);p(L,o,!0),p(Tt,!0)}catch(o){p(F,o instanceof Error?o.message:"Failed to load BoAmps report",!0)}finally{p(st,!1)}}function k(r,o=2){return r.toFixed(o)}function Ut(r){return r<60?`${Math.round(r)}s`:r<3600?`${Math.round(r/60)}m`:`${Math.round(r/3600)}h ${Math.round(r%3600/60)}m`}function It(r){return new Date(r).toLocaleString()}function ft(r){return r<.01?"text-green-600":r<.1?"text-yellow-600":"text-red-600"}function At(){const r=["Job ID","Job Name","Stage","Model","Timestamp","Duration (s)","Energy (kWh)","Emissions (kg CO2)","Carbon Intensity (g/kWh)","Country"],o=a(at).map(c=>[c.job_id,c.job_name,c.stage,c.model_name,c.timestamp,c.duration.toString(),c.energy_consumed.toString(),c.emissions_kg.toString(),c.carbon_intensity.toString(),c.country]),b=[r,...o].map(c=>c.join(",")).join(`
`),f=new Blob([b],{type:"text/csv"}),j=URL.createObjectURL(f),$=document.createElement("a");$.href=j,$.download=`emissions-report-${new Date().toISOString().split("T")[0]}.csv`,$.click(),URL.revokeObjectURL(j)}ce(()=>{xt()});var yt=Me();ue(r=>{_e.title="Emissions - Model Garden"});var it=gt(yt),bt=e(it),ot=e(bt),Ft=s(e(ot),2);{let r=I(()=>a(h).length===0);A(Ft,{onclick:At,variant:"secondary",get disabled(){return a(r)},children:(o,b)=>{w();var f=B("üì• Export CSV");v(o,f)},$$slots:{default:!0}})}t(ot);var $t=s(ot,2);{var Jt=r=>{var o=be(),b=e(o),f=s(e(b),2),j=e(f),$=e(j,!0);t(j),t(f);var c=s(f,2);c.__click=[ye,F],t(b),t(o),D(()=>g($,a(F))),v(r,o)};N($t,r=>{a(F)&&r(Jt)})}var Nt=s($t,2);{var Wt=r=>{var o=$e();v(r,o)},zt=r=>{var o=Be(),b=gt(o),f=e(b);R(f,{children:(u,y)=>{var d=he(),i=s(e(d),2),_=e(i,!0);t(i),t(d),D(()=>g(_,a(h).length)),v(u,d)},$$slots:{default:!0}});var j=s(f,2);R(j,{children:(u,y)=>{var d=we(),i=s(e(d),2),_=e(i);t(i),w(2),t(d),D((l,n)=>{Bt(i,1,`text-3xl font-bold ${l??""}`),g(_,`${n??""} kg`)},[()=>ft(a(pt)),()=>k(a(pt),3)]),v(u,d)},$$slots:{default:!0}});var $=s(j,2);R($,{children:(u,y)=>{var d=ke(),i=s(e(d),2),_=e(i);t(i),t(d),D(l=>g(_,`${l??""} kWh`),[()=>k(a(Lt),2)]),v(u,d)},$$slots:{default:!0}});var c=s($,2);R(c,{children:(u,y)=>{var d=je(),i=s(e(d),2),_=e(i,!0);t(i),w(2),t(d),D(l=>g(_,l),[()=>k(a(Ot),0)]),v(u,d)},$$slots:{default:!0}}),t(b);var z=s(b,2);R(z,{class:"mb-6",children:(u,y)=>{var d=Ee(),i=e(d),_=e(i),l=s(e(_),2),n=e(l);n.value=n.__value="all";var m=s(n);m.value=m.__value="training";var S=s(m);S.value=S.__value="inference",t(l),t(_);var O=s(_,2),T=s(e(O),2),G=e(T);G.value=G.__value="date";var V=s(G);V.value=V.__value="emissions";var H=s(V);H.value=H.__value="duration",t(T),t(O);var J=s(O,2),X=e(J);A(X,{onclick:xt,variant:"secondary",size:"sm",children:(M,Y)=>{w();var K=B("üîÑ Refresh");v(M,K)},$$slots:{default:!0}}),t(J),t(i),t(d),Dt(l,()=>a(Q),M=>p(Q,M)),Dt(T,()=>a(rt),M=>p(rt,M)),v(u,d)},$$slots:{default:!0}});var dt=s(z,2);{var q=u=>{R(u,{children:(y,d)=>{var i=Se(),_=s(e(i),6);A(_,{href:"/training/new",variant:"primary",children:(l,n)=>{w();var m=B("Start Training");v(l,m)},$$slots:{default:!0}}),t(i),v(y,i)},$$slots:{default:!0}})},lt=u=>{var y=Ce();ge(y,21,()=>a(at),xe,(d,i)=>{R(d,{class:"hover:shadow-md transition-shadow",children:(_,l)=>{var n=Pe(),m=e(n),S=e(m),O=e(S),T=e(O),G=e(T,!0);t(T);var V=s(T,2);{let E=I(()=>a(i).stage==="training"?"info":"success");fe(V,{get variant(){return a(E)},children:(U,Z)=>{w();var P=B();D(()=>g(P,a(i).stage)),v(U,P)},$$slots:{default:!0}})}t(O);var H=s(O,2),J=e(H),X=s(e(J),2),M=e(X,!0);t(X),t(J);var Y=s(J,2),K=s(e(Y),2),Vt=e(K);t(K),t(Y);var vt=s(Y,2),ht=s(e(vt),2),Ht=e(ht);t(ht),t(vt);var nt=s(vt,2),wt=s(e(nt),2),Kt=e(wt,!0);t(wt),t(nt);var ct=s(nt,2),kt=s(e(ct),2),Qt=e(kt);t(kt),t(ct);var ut=s(ct,2),jt=s(e(ut),2),Xt=e(jt,!0);t(jt),t(ut);var mt=s(ut,2),_t=s(e(mt),2),Yt=e(_t,!0);t(_t),t(mt);var Et=s(mt,2),St=s(e(Et),2),Zt=e(St);t(St),t(Et),t(H),t(S);var Pt=s(S,2),Ct=e(Pt);{var te=E=>{A(E,{onclick:()=>Mt(a(i).job_id),variant:"secondary",size:"sm",children:(U,Z)=>{w();var P=B("üìÑ BoAmps");v(U,P)},$$slots:{default:!0}})};N(Ct,E=>{a(i).boamps_report&&E(te)})}var ee=s(Ct,2);{let E=I(()=>`/training/${a(i).job_id}`);A(ee,{get href(){return a(E)},variant:"ghost",size:"sm",children:(U,Z)=>{w();var P=B("View Job");v(U,P)},$$slots:{default:!0}})}t(Pt),t(m),t(n),D((E,U,Z,P,re,ae,se,ie,oe,de)=>{g(G,a(i).job_name||a(i).job_id),g(M,a(i).model_name),Bt(K,1,`font-medium ${E??""}`),g(Vt,`${U??""} kg CO‚ÇÇ`),g(Ht,`${Z??""} kWh`),g(Kt,P),g(Qt,`${re??""} g/kWh`),g(Xt,a(i).country),pe(_t,"title",ae),g(Yt,se),g(Zt,`CPU: ${ie??""} | 
                          GPU: ${oe??""} | 
                          RAM: ${de??""}`)},[()=>ft(a(i).emissions_kg),()=>k(a(i).emissions_kg,4),()=>k(a(i).energy_consumed,3),()=>Ut(a(i).duration),()=>k(a(i).carbon_intensity,0),()=>It(a(i).timestamp),()=>new Date(a(i).timestamp).toLocaleDateString(),()=>k(a(i).cpu_energy,2),()=>k(a(i).gpu_energy,2),()=>k(a(i).ram_energy,2)]),v(_,n)},$$slots:{default:!0}})}),t(y),v(u,y)};N(dt,u=>{a(at).length===0?u(q):u(lt,!1)})}v(r,o)};N(Nt,r=>{a(et)?r(Wt):r(zt,!1)})}t(bt),t(it);var qt=s(it,2);{var Gt=r=>{var o=Te(),b=e(o);R(b,{class:"max-w-4xl w-full max-h-[80vh] flex flex-col",children:(f,j)=>{var $=Oe(),c=gt($),z=e(c),dt=s(e(z),2);dt.__click=[De,L],t(z),t(c);var q=s(c,2),lt=e(q);{var u=l=>{var n=Re();v(l,n)},y=l=>{var n=Le(),m=e(n,!0);t(n),D(S=>g(m,S),[()=>JSON.stringify(a(L),null,2)]),v(l,n)};N(lt,l=>{a(st)?l(u):l(y,!1)})}t(q);var d=s(q,2),i=e(d);A(i,{onclick:()=>{const l=new Blob([JSON.stringify(a(L),null,2)],{type:"application/json"}),n=URL.createObjectURL(l),m=document.createElement("a");m.href=n,m.download=`boamps-report-${a(L).header?.reportId||"report"}.json`,m.click(),URL.revokeObjectURL(n)},variant:"secondary",children:(l,n)=>{w();var m=B("üì• Download JSON");v(l,m)},$$slots:{default:!0}});var _=s(i,2);A(_,{onclick:()=>{p(L,null)},variant:"secondary",fullWidth:!0,children:(l,n)=>{w();var m=B("Close");v(l,m)},$$slots:{default:!0}}),t(d),v(f,$)},$$slots:{default:!0}}),t(o),v(r,o)};N(qt,r=>{a(L)&&r(Gt)})}v(tt,yt),me()}le(["click"]);export{ze as component};
