import"../chunks/DsnmJJEf.js";import{q as Ge,p as Ne,s as D,a as oe,o as Ie,f as b,h as Je,b as g,c as ze,$ as Ae,d as c,t as V,i as e,e as a,g as s,n as G,r as t,k as U,v as ye,l as z,m as N,u as Be,j as He}from"../chunks/Bl5r8RQ7.js";import{i as K}from"../chunks/CBxzvLcE.js";import{a as Ke,e as be,i as he,r as A,s as ie}from"../chunks/BbziM7gO.js";import{b as W,a as we,c as We}from"../chunks/DHGAAW6u.js";import{b as Fe}from"../chunks/B3KcI-5V.js";import{B as X,C as F,a as Re}from"../chunks/DatEFAiE.js";function Ye(R,Z){R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),Z())}var qe=b('<div class="text-center py-12"><div class="text-6xl mb-4">💬</div> <h3 class="text-xl font-semibold text-gray-700 mb-2">Start a Conversation</h3> <p class="text-gray-500">Select a model and type a message below</p></div>'),Le=b('<div><div><div class="flex items-start gap-2"><div class="flex-1"><div class="text-xs opacity-70 mb-1"> </div> <div class="whitespace-pre-wrap break-words"> </div></div></div></div></div>'),Ue=b('<div class="flex justify-start"><div class="max-w-[80%] rounded-lg px-4 py-3 bg-gray-100 text-gray-900"><div class="text-xs opacity-70 mb-1">Assistant · Typing...</div> <div class="whitespace-pre-wrap break-words"> <span class="inline-block w-1 h-4 bg-gray-600 animate-pulse ml-1"></span></div></div></div>'),Qe=b("<!> <!>",1),Ve=b('<div class="flex-1 overflow-y-auto p-6 space-y-4"><!></div> <div class="border-t border-gray-200 p-4"><div class="flex gap-3"><textarea rows="2" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none disabled:bg-gray-100 disabled:cursor-not-allowed"></textarea> <!></div></div>',1),Xe=b('<div class="flex items-center justify-center py-4"><div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"></div></div>'),Ze=b('<p class="text-sm text-gray-500 mb-3">No models available</p> <!>',1),et=b("<option> </option>"),tt=b('<select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"></select>'),at=b('<div class="p-4"><h3 class="text-lg font-semibold text-gray-900 mb-3">Model</h3> <!></div>'),rt=b('<div class="p-4"><h3 class="text-lg font-semibold text-gray-900 mb-3">Mode</h3> <div class="space-y-2"><label class="flex items-center"><input type="radio" class="mr-2"/> <span class="text-sm">Chat (with context)</span></label> <label class="flex items-center"><input type="radio" class="mr-2"/> <span class="text-sm">Completion (stateless)</span></label></div></div>'),st=b('<div class="p-4"><h3 class="text-lg font-semibold text-gray-900 mb-3">Generation Settings</h3> <div class="space-y-4"><div><label for="temperature" class="block text-sm font-medium text-gray-700 mb-1"> </label> <input type="range" id="temperature" min="0.0" max="2.0" step="0.1" class="w-full"/> <p class="text-xs text-gray-500 mt-1">Higher = more creative</p></div> <div><label for="max-tokens" class="block text-sm font-medium text-gray-700 mb-1">Max Tokens</label> <input type="number" id="max-tokens" min="1" max="2000" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm"/></div> <div><label for="top-p" class="block text-sm font-medium text-gray-700 mb-1"> </label> <input type="range" id="top-p" min="0.0" max="1.0" step="0.05" class="w-full"/></div> <div><label for="top-k" class="block text-sm font-medium text-gray-700 mb-1">Top K</label> <input type="number" id="top-k" min="1" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm"/></div> <div><label class="flex items-center"><input type="checkbox" class="mr-2"/> <span class="text-sm font-medium text-gray-700">Enable Streaming</span></label></div></div></div>'),ot=b(`<div class="p-4"><h3 class="text-lg font-semibold text-gray-900 mb-3">System Prompt</h3> <textarea rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm resize-none" placeholder="Set the assistant's behavior..."></textarea></div>`),it=b("<!> <!>",1),nt=b('<div class="p-4"><h3 class="text-lg font-semibold text-gray-900 mb-3">Conversation</h3> <div class="space-y-2 text-sm"><div class="flex justify-between"><span class="text-gray-600">Messages:</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-gray-600">Status:</span> <span> </span></div></div></div>'),lt=b('<div class="min-h-screen bg-gray-50"><div class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center py-6"><h1 class="text-3xl font-bold text-gray-900">Inference</h1> <div class="flex gap-3"><!> <!></div></div></div></div> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="grid grid-cols-1 lg:grid-cols-4 gap-6"><div class="lg:col-span-3"><!></div> <div class="space-y-6"><!> <!> <!> <!></div></div></div></div>');function _t(R,Z){Ne(Z,!0);const ne=[];let Y=D(oe([])),O=D(""),q=D(!0),i=D(oe([])),I=D(""),C=D(!1),S=D(""),B=D("chat"),f=oe({temperature:.7,max_tokens:500,top_p:.9,top_k:50,stream:!0}),ee=D("You are a helpful AI assistant."),te=D(!1);async function $e(){try{c(q,!0);const o=await Re.getModels();c(Y,o.models||o.items||[],!0),e(Y).length>0&&!e(O)&&c(O,e(Y)[0].name,!0)}catch(o){console.error("Failed to load models:",o)}finally{c(q,!1)}}async function le(){if(!e(I).trim()||!e(O)||e(C))return;const o={role:"user",content:e(I).trim(),timestamp:new Date};c(i,[...e(i),o],!0);const h=e(I);c(I,""),c(C,!0),c(S,"");try{e(B)==="chat"?await ke(h):await Pe(h)}catch(r){console.error("Generation error:",r),c(i,[...e(i),{role:"assistant",content:"Error: Failed to generate response. Please try again.",timestamp:new Date}],!0)}finally{c(C,!1)}}async function ke(o){const h={role:"assistant",content:"",timestamp:new Date};c(i,[...e(i),h],!0);try{const r=[{role:"system",content:e(ee)},...e(i).slice(0,-1).map(_=>({role:_.role,content:_.content})),{role:"user",content:o}],v=await fetch("/api/v1/inference/chat/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:e(O),messages:r,temperature:f.temperature,max_tokens:f.max_tokens,top_p:f.top_p,stream:f.stream})});if(!v.ok)throw new Error(`HTTP error! status: ${v.status}`);if(f.stream&&v.body){const _=v.body.getReader(),p=new TextDecoder;let x="";for(;;){const{done:l,value:d}=await _.read();if(l)break;x+=p.decode(d,{stream:!0});const m=x.split(`
`);x=m.pop()||"";for(const w of m)if(w.startsWith("data: ")){const n=w.slice(6);if(n==="[DONE]")continue;try{const y=JSON.parse(n).choices[0]?.delta?.content||"";y&&(c(S,e(S)+y),e(i)[e(i).length-1].content=e(S))}catch(u){console.error("Parse error:",u)}}}}else{const _=await v.json();e(i)[e(i).length-1].content=_.choices[0].message.content}}catch(r){throw e(i)[e(i).length-1].content="Error generating response",r}finally{c(S,"")}}async function Pe(o){const h={role:"assistant",content:"",timestamp:new Date};c(i,[...e(i),h],!0);try{const r=await fetch("/api/v1/inference/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:e(O),prompt:o,temperature:f.temperature,max_tokens:f.max_tokens,top_p:f.top_p,stream:f.stream})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);if(f.stream&&r.body){const v=r.body.getReader(),_=new TextDecoder;let p="";for(;;){const{done:x,value:l}=await v.read();if(x)break;p+=_.decode(l,{stream:!0});const d=p.split(`
`);p=d.pop()||"";for(const m of d)if(m.startsWith("data: ")){const w=m.slice(6);if(w==="[DONE]")continue;try{const u=JSON.parse(w).choices[0]?.text||"";u&&(c(S,e(S)+u),e(i)[e(i).length-1].content=e(S))}catch(n){console.error("Parse error:",n)}}}}else{const v=await r.json();e(i)[e(i).length-1].content=v.choices[0].text}}catch(r){throw e(i)[e(i).length-1].content="Error generating response",r}finally{c(S,"")}}function Se(){confirm("Clear all messages?")&&(c(i,[],!0),c(S,""))}function Te(o){return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}Ie(()=>{$e()});var ae=lt();Je(o=>{Ae.title="Inference - Model Garden"});var re=a(ae),de=a(re),ce=a(de),ve=s(a(ce),2),pe=a(ve);X(pe,{onclick:()=>c(te,!e(te)),variant:"secondary",children:(o,h)=>{G();var r=V("⚙️ Settings");g(o,r)},$$slots:{default:!0}});var Me=s(pe,2);X(Me,{onclick:Se,variant:"secondary",children:(o,h)=>{G();var r=V("🗑️ Clear");g(o,r)},$$slots:{default:!0}}),t(ve),t(ce),t(de),t(re);var me=s(re,2),ue=a(me),se=a(ue),Ce=a(se);F(Ce,{class:"h-[calc(100vh-16rem)] flex flex-col",children:(o,h)=>{var r=Ve(),v=U(r),_=a(v);{var p=n=>{var u=qe();g(n,u)},x=n=>{var u=Qe(),y=U(u);be(y,17,()=>e(i),he,(P,$)=>{var j=Le(),E=a(j),J=a(E),L=a(J),H=a(L),Q=a(H);t(H);var M=s(H,2),De=a(M,!0);t(M),t(L),t(J),t(E),t(j),z(Oe=>{ie(j,1,`flex ${e($).role==="user"?"justify-end":"justify-start"}`),ie(E,1,`max-w-[80%] rounded-lg px-4 py-3 ${e($).role==="user"?"bg-primary-600 text-white":"bg-gray-100 text-gray-900"}`),N(Q,`${e($).role==="user"?"You":"Assistant"} · ${Oe??""}`),N(De,e($).content)},[()=>Te(e($).timestamp)]),g(P,j)});var k=s(y,2);{var T=P=>{var $=Ue(),j=a($),E=s(a(j),2),J=a(E,!0);G(),t(E),t(j),t($),z(()=>N(J,e(S))),g(P,$)};K(k,P=>{e(C)&&e(S)&&P(T)})}g(n,u)};K(_,n=>{e(i).length===0?n(p):n(x,!1)})}t(v);var l=s(v,2),d=a(l),m=a(d);ye(m),m.__keydown=[Ye,le];var w=s(m,2);{let n=Be(()=>!e(I).trim()||e(C)||!e(O)||e(q));X(w,{onclick:le,variant:"primary",get disabled(){return e(n)},get loading(){return e(C)},class:"self-end",children:(u,y)=>{G();var k=V();z(()=>N(k,e(C)?"Generating...":"Send")),g(u,k)},$$slots:{default:!0}})}t(d),t(l),z(()=>{Ke(m,"placeholder",e(C)?"Generating...":"Type your message... (Enter to send, Shift+Enter for new line)"),m.disabled=e(C)||!e(O)||e(q)}),W(m,()=>e(I),n=>c(I,n)),g(o,r)},$$slots:{default:!0}}),t(se);var fe=s(se,2),_e=a(fe);F(_e,{children:(o,h)=>{var r=at(),v=s(a(r),2);{var _=x=>{var l=Xe();g(x,l)},p=x=>{var l=He(),d=U(l);{var m=n=>{var u=Ze(),y=s(U(u),2);X(y,{href:"/models",variant:"primary",size:"sm",fullWidth:!0,children:(k,T)=>{G();var P=V("Browse Models");g(k,P)},$$slots:{default:!0}}),g(n,u)},w=n=>{var u=tt();be(u,21,()=>e(Y),he,(y,k)=>{var T=et(),P=a(T,!0);t(T);var $={};z(()=>{N(P,e(k).name),$!==($=e(k).name)&&(T.value=(T.__value=e(k).name)??"")}),g(y,T)}),t(u),Fe(u,()=>e(O),y=>c(O,y)),g(n,u)};K(d,n=>{e(Y).length===0?n(m):n(w,!1)},!0)}g(x,l)};K(v,x=>{e(q)?x(_):x(p,!1)})}t(r),g(o,r)},$$slots:{default:!0}});var xe=s(_e,2);F(xe,{children:(o,h)=>{var r=rt(),v=s(a(r),2),_=a(v),p=a(_);A(p),p.value=p.__value="chat",G(2),t(_);var x=s(_,2),l=a(x);A(l),l.value=l.__value="completion",G(2),t(x),t(v),t(r),we(ne,[],p,()=>e(B),d=>c(B,d)),we(ne,[],l,()=>e(B),d=>c(B,d)),g(o,r)},$$slots:{default:!0}});var ge=s(xe,2);{var je=o=>{var h=it(),r=U(h);F(r,{children:(p,x)=>{var l=st(),d=s(a(l),2),m=a(d),w=a(m),n=a(w);t(w);var u=s(w,2);A(u),G(2),t(m);var y=s(m,2),k=s(a(y),2);A(k),t(y);var T=s(y,2),P=a(T),$=a(P);t(P);var j=s(P,2);A(j),t(T);var E=s(T,2),J=s(a(E),2);A(J),t(E);var L=s(E,2),H=a(L),Q=a(H);A(Q),G(2),t(H),t(L),t(d),t(l),z(()=>{N(n,`Temperature: ${f.temperature??""}`),N($,`Top P: ${f.top_p??""}`)}),W(u,()=>f.temperature,M=>f.temperature=M),W(k,()=>f.max_tokens,M=>f.max_tokens=M),W(j,()=>f.top_p,M=>f.top_p=M),W(J,()=>f.top_k,M=>f.top_k=M),We(Q,()=>f.stream,M=>f.stream=M),g(p,l)},$$slots:{default:!0}});var v=s(r,2);{var _=p=>{F(p,{children:(x,l)=>{var d=ot(),m=s(a(d),2);ye(m),t(d),W(m,()=>e(ee),w=>c(ee,w)),g(x,d)},$$slots:{default:!0}})};K(v,p=>{e(B)==="chat"&&p(_)})}g(o,h)};K(ge,o=>{e(te)&&o(je)})}var Ee=s(ge,2);F(Ee,{children:(o,h)=>{var r=nt(),v=s(a(r),2),_=a(v),p=s(a(_),2),x=a(p,!0);t(p),t(_);var l=s(_,2),d=s(a(l),2),m=a(d,!0);t(d),t(l),t(v),t(r),z(()=>{N(x,e(i).length),ie(d,1,`font-medium ${e(C)?"text-green-600":"text-gray-900"}`),N(m,e(C)?"🟢 Generating":"⚪ Idle")}),g(o,r)},$$slots:{default:!0}}),t(fe),t(ue),t(me),t(ae),g(R,ae),ze()}Ge(["keydown"]);export{_t as component};
